<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•œå¤´7ï¼šæ—¶è¾°è½®ç›˜ä¿®è¡Œ - ä»£å·qin</title>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(180deg, #2F4F4F 0%, #1C1C1C 50%, #000000 100%);
            overflow: hidden;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        #scene7-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }
        
        /* æœºå…³åŸèƒŒæ™¯ */
        .mechanism-city {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(139, 69, 19, 0.3) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(160, 82, 45, 0.2) 0%, transparent 40%),
                linear-gradient(45deg, transparent 0%, rgba(105, 105, 105, 0.1) 50%, transparent 100%);
        }
        
        /* æ—¶è¾°è½®ç›˜ */
        .time-wheel {
            position: absolute;
            top: 50%;
            left: 30%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 300px;
            border: 5px solid #DAA520;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(218, 165, 32, 0.1) 0%, transparent 70%);
            animation: wheelRotate 60s linear infinite;
        }
        
        @keyframes wheelRotate {
            from { transform: translate(-50%, -50%) rotate(0deg); }
            to { transform: translate(-50%, -50%) rotate(360deg); }
        }
        
        .time-sector {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: 100% 100%;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .time-sector:hover {
            filter: brightness(1.3);
        }
        
        .time-sector.active {
            filter: brightness(1.5) saturate(1.2);
        }
        
        .sector-label {
            position: absolute;
            top: 20%;
            left: 60%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 12px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            pointer-events: none;
        }
        
        .sector-activity {
            position: absolute;
            top: 40%;
            left: 60%;
            transform: translate(-50%, -50%);
            color: rgba(255, 255, 255, 0.8);
            font-size: 10px;
            text-align: center;
            pointer-events: none;
            line-height: 1.2;
        }
        
        /* ä¿®è¡Œé¢æ¿ */
        .cultivation-panel {
            position: absolute;
            top: 10%;
            right: 5%;
            width: 350px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #DAA520;
            border-radius: 15px;
            padding: 20px;
            color: white;
        }
        
        .panel-title {
            color: #DAA520;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .current-time {
            text-align: center;
            font-size: 16px;
            margin-bottom: 20px;
            padding: 10px;
            background: rgba(218, 165, 32, 0.2);
            border-radius: 8px;
        }
        
        .cultivation-activity {
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            border-left: 4px solid #32CD32;
        }
        
        .activity-name {
            font-weight: bold;
            color: #90EE90;
            margin-bottom: 5px;
        }
        
        .activity-description {
            font-size: 12px;
            opacity: 0.8;
            line-height: 1.4;
        }
        
        .activity-progress {
            margin-top: 8px;
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #32CD32 0%, #90EE90 100%);
            transition: width 2s ease-out;
        }
        
        /* å¸ˆçˆ¶é€‰æ‹©é¢æ¿ */
        .master-selection {
            position: absolute;
            bottom: 10%;
            left: 5%;
            width: 400px;
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #FFD700;
            border-radius: 15px;
            padding: 20px;
            color: white;
        }
        
        .masters-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .master-card {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #666;
            border-radius: 10px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .master-card:hover {
            border-color: #FFD700;
            background: rgba(255, 215, 0, 0.2);
            transform: translateY(-2px);
        }
        
        .master-card.selected {
            border-color: #32CD32;
            background: rgba(50, 205, 50, 0.2);
        }
        
        .master-name {
            font-weight: bold;
            font-size: 12px;
            margin-bottom: 3px;
            color: #FFD700;
        }
        
        .master-skill {
            font-size: 10px;
            opacity: 0.8;
            line-height: 1.2;
        }
        
        /* ç‰¹æ®Šäº‹ä»¶å¼¹çª— */
        .special-event {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 30px;
            border-radius: 15px;
            border: 3px solid #FF6347;
            text-align: center;
            z-index: 99999;
            max-width: 400px;
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.8);
            transition: all 0.5s ease;
        }
        
        .special-event.show {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }
        
        .event-title {
            color: #FF6347;
            font-size: 20px;
            margin-bottom: 15px;
        }
        
        .event-description {
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        /* æ—¥ç¨‹è¡¨ */
        .schedule-display {
            position: absolute;
            top: 50%;
            right: 50px;
            transform: translateY(-50%);
            width: 200px;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #666;
            border-radius: 10px;
            padding: 15px;
            color: white;
        }
        
        .schedule-item {
            margin-bottom: 10px;
            padding: 5px;
            border-radius: 5px;
            font-size: 11px;
        }
        
        .schedule-item.current {
            background: rgba(218, 165, 32, 0.3);
            border-left: 3px solid #DAA520;
        }
        
        .schedule-item.completed {
            opacity: 0.5;
            text-decoration: line-through;
        }
        
        /* æ§åˆ¶é¢æ¿ */
        .controls {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-size: 12px;
            z-index: 10000;
            min-width: 200px;
            border: 1px solid #333;
        }
        
        .control-button {
            display: block;
            width: 100%;
            margin: 5px 0;
            padding: 8px;
            background: #333;
            color: white;
            border: 1px solid #666;
            border-radius: 5px;
            cursor: pointer;
            font-size: 11px;
            transition: background 0.3s;
        }
        
        .control-button:hover {
            background: #555;
        }
        
        .status {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #666;
            font-size: 10px;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div id="scene7-container">
        <!-- æœºå…³åŸèƒŒæ™¯ -->
        <div class="mechanism-city"></div>
        
        <!-- æ—¶è¾°è½®ç›˜ -->
        <div class="time-wheel" id="time-wheel">
            <!-- æ—¶è¾°æ‰‡åŒºå°†é€šè¿‡JavaScriptç”Ÿæˆ -->
        </div>
        
        <!-- ä¿®è¡Œé¢æ¿ -->
        <div class="cultivation-panel">
            <div class="panel-title">ğŸ“¿ ä¿®è¡Œæ—¥å¸¸</div>
            
            <div class="current-time">
                <div>å½“å‰æ—¶è¾°ï¼š<span id="current-time">å¯æ—¶</span></div>
                <div>æ—¶é—´ï¼š<span id="time-range">5:00-7:00</span></div>
            </div>
            
            <div class="cultivation-activity" id="current-activity">
                <div class="activity-name" id="activity-name">æ™¨ç»ƒï¼ˆåçº³æ˜Ÿè¾‰ä¹‹åŠ›ï¼‰</div>
                <div class="activity-description" id="activity-description">
                    é€šè¿‡ç‰¹æ®Šçš„å‘¼å¸æ³•ï¼Œå¸æ”¶æ¸…æ™¨çš„æ˜Ÿè¾‰æ®‹ç•™èƒ½é‡ï¼Œå¢å¼ºä½“è´¨å’ŒçµåŠ›ã€‚
                </div>
                <div class="activity-progress">
                    <div class="progress-fill" id="activity-progress" style="width: 0%"></div>
                </div>
            </div>
            
            <button class="control-button" onclick="startCultivation()" style="width: 100%; margin-top: 10px;">
                å¼€å§‹ä¿®è¡Œ
            </button>
        </div>
        
        <!-- å¸ˆçˆ¶é€‰æ‹©é¢æ¿ -->
        <div class="master-selection">
            <div class="panel-title">ğŸ“ é€‰æ‹©å¸ˆçˆ¶</div>
            <div style="font-size: 12px; opacity: 0.8; margin-bottom: 10px;">
                ä¸åŒçš„å¸ˆçˆ¶å°†æ•™æˆä¸åŒçš„æŠ€èƒ½è·¯çº¿
            </div>
            
            <div class="masters-grid">
                <div class="master-card" onclick="selectMaster('jingke')">
                    <div class="master-name">è†è½²</div>
                    <div class="master-skill">åˆºå®¢<br/>æš—æ€ä¹‹æœ¯</div>
                </div>
                <div class="master-card selected" onclick="selectMaster('mozi')">
                    <div class="master-name">å¢¨å­</div>
                    <div class="master-skill">å¢¨è€…<br/>æœºå…³æœ¯</div>
                </div>
                <div class="master-card" onclick="selectMaster('liguang')">
                    <div class="master-name">æå¹¿</div>
                    <div class="master-skill">å°„æ‰‹<br/>éª‘å°„ä¹‹æœ¯</div>
                </div>
                <div class="master-card" onclick="selectMaster('yuefei')">
                    <div class="master-name">å²³é£</div>
                    <div class="master-skill">æ­¦å£«<br/>æå‡»ä¹‹æœ¯</div>
                </div>
                <div class="master-card" onclick="selectMaster('huatuo')">
                    <div class="master-name">åä½—</div>
                    <div class="master-skill">åŒ»è€…<br/>æ²»æ„ˆä¹‹æœ¯</div>
                </div>
                <div class="master-card" onclick="selectMaster('zuoci')">
                    <div class="master-name">å·¦æ…ˆ</div>
                    <div class="master-skill">é“å£«<br/>æ–¹å¯¸å¥‡æœ¯</div>
                </div>
            </div>
        </div>
        
        <!-- æ—¥ç¨‹è¡¨æ˜¾ç¤º -->
        <div class="schedule-display">
            <h4 style="margin-bottom: 10px; color: #DAA520;">ä»Šæ—¥ä¿®è¡Œ</h4>
            <div class="schedule-item current">
                <strong>å¯æ—¶</strong> - æ™¨ç»ƒ
            </div>
            <div class="schedule-item">
                <strong>å·³æ—¶</strong> - æœºå…³æœ¯å…¥é—¨
            </div>
            <div class="schedule-item">
                <strong>åˆæ—¶</strong> - åˆä¼‘ç ”è¯»
            </div>
            <div class="schedule-item">
                <strong>æœªæ—¶</strong> - å¥‡é—¨éç”²
            </div>
            <div class="schedule-item">
                <strong>ç”³æ—¶</strong> - å®æˆ˜å¯¹æŠ—
            </div>
        </div>
        
        <!-- ç‰¹æ®Šäº‹ä»¶å¼¹çª— -->
        <div class="special-event" id="special-event">
            <div class="event-title" id="event-title">ç‰¹æ®Šäº‹ä»¶</div>
            <div class="event-description" id="event-description">äº‹ä»¶æè¿°</div>
            <button onclick="closeSpecialEvent()" 
                    style="padding: 10px 20px; background: #FF6347; color: #fff; border: none; border-radius: 5px; cursor: pointer;">
                ç¡®å®š
            </button>
        </div>
        
        <!-- æ§åˆ¶é¢æ¿ -->
        <div class="controls">
            <h4 style="margin: 0 0 10px 0; color: #DAA520;">é•œå¤´7ï¼šä¿®è¡Œç³»ç»Ÿ</h4>
            <button class="control-button" onclick="startCultivation()">å¼€å§‹ä¿®è¡Œ</button>
            <button class="control-button" onclick="nextTimeSlot()">ä¸‹ä¸€æ—¶è¾°</button>
            <button class="control-button" onclick="triggerSpecialEvent()">è§¦å‘ç‰¹æ®Šäº‹ä»¶</button>
            <button class="control-button" onclick="autoProgress()">è‡ªåŠ¨è¿›åº¦</button>
            <button class="control-button" onclick="nextScene()">å®Œæˆä¿®è¡Œ</button>
            <button class="control-button" onclick="restartScene()">é‡æ–°å¼€å§‹</button>
            
            <div class="status">
                <div>å½“å‰æ—¶è¾°: <span id="status-time">å¯æ—¶</span></div>
                <div>ä¿®è¡Œè¿›åº¦: <span id="cultivation-progress">0%</span></div>
                <div>é€‰æ‹©å¸ˆçˆ¶: <span id="selected-master">å¢¨å­</span></div>
                <div>è·å¾—ç»éªŒ: <span id="gained-exp">0</span></div>
            </div>
        </div>
    </div>

    <script>
        class Scene7Cultivation {
            constructor() {
                this.container = document.getElementById('scene7-container');
                this.timeWheel = document.getElementById('time-wheel');
                this.currentTimeSpan = document.getElementById('current-time');
                this.timeRangeSpan = document.getElementById('time-range');
                this.activityName = document.getElementById('activity-name');
                this.activityDescription = document.getElementById('activity-description');
                this.activityProgress = document.getElementById('activity-progress');
                this.specialEvent = document.getElementById('special-event');
                this.eventTitle = document.getElementById('event-title');
                this.eventDescription = document.getElementById('event-description');
                this.statusTime = document.getElementById('status-time');
                this.cultivationProgressSpan = document.getElementById('cultivation-progress');
                this.selectedMasterSpan = document.getElementById('selected-master');
                this.gainedExpSpan = document.getElementById('gained-exp');
                
                this.currentTimeSlot = 0;
                this.cultivationProgress = 0;
                this.selectedMaster = 'mozi';
                this.gainedExp = 0;
                this.isTraining = false;
                
                // æ—¶è¾°æ•°æ®
                this.timeSlots = [
                    {
                        name: 'å¯æ—¶',
                        time: '5:00-7:00',
                        activity: 'æ™¨ç»ƒï¼ˆåçº³æ˜Ÿè¾‰ä¹‹åŠ›ï¼‰',
                        description: 'é€šè¿‡ç‰¹æ®Šçš„å‘¼å¸æ³•ï¼Œå¸æ”¶æ¸…æ™¨çš„æ˜Ÿè¾‰æ®‹ç•™èƒ½é‡ï¼Œå¢å¼ºä½“è´¨å’ŒçµåŠ›ã€‚',
                        color: '#FFB6C1',
                        angle: 0,
                        specialEvent: 'ç‰ä½©æ„å¤–å…±é¸£ï¼Œè§¦å‘"æ˜Ÿè¾‰çŒä½“"'
                    },
                    {
                        name: 'è¾°æ—¶',
                        time: '7:00-9:00',
                        activity: 'æ—©è†³ä¸ç†è®ºå­¦ä¹ ',
                        description: 'äº«ç”¨ç®€å•æ—©è†³ï¼Œå­¦ä¹ å¢¨å®¶ç†è®ºå’Œæœºå…³å­¦åŸºç¡€çŸ¥è¯†ã€‚',
                        color: '#DDA0DD',
                        angle: 45
                    },
                    {
                        name: 'å·³æ—¶',
                        time: '9:00-11:00',
                        activity: 'æœºå…³æœ¯å…¥é—¨',
                        description: 'å­¦ä¹ åŸºç¡€æœºå…³åˆ¶ä½œï¼Œä»ç®€å•çš„æœºå…³æœ¨äººå¼€å§‹ç»ƒä¹ ã€‚',
                        color: '#98FB98',
                        angle: 90,
                        specialEvent: 'è¯¯è§¦æœºå…³ï¼Œæ•´åº§åŸæ± è­¦æŠ¥å¤§ä½œ'
                    },
                    {
                        name: 'åˆæ—¶',
                        time: '11:00-13:00',
                        activity: 'åˆä¼‘ & å¢¨å®¶å…¸ç±ç ”è¯»',
                        description: 'åˆä¼‘æ¢å¤ç²¾åŠ›ï¼Œç ”è¯»å¢¨å®¶ç»å…¸å’Œå¤ç±ã€‚',
                        color: '#F0E68C',
                        angle: 135,
                        specialEvent: 'å¬´æ”¿å‘ç°ã€Šé¾™é­‚ç‰å½•ã€‹æ®‹å·'
                    },
                    {
                        name: 'æœªæ—¶',
                        time: '13:00-15:00',
                        activity: 'å¥‡é—¨éç”²æ¼”ç»ƒ',
                        description: 'å­¦ä¹ é˜µæ³•å’Œéç”²ä¹‹æœ¯ï¼Œæå‡æˆ˜æœ¯æ€ç»´ã€‚',
                        color: '#87CEEB',
                        angle: 180,
                        specialEvent: 'ä¸¤äººè¢«å›°å¹»é˜µï¼Œéœ€åˆä½œç ´è§£'
                    },
                    {
                        name: 'ç”³æ—¶',
                        time: '15:00-17:00',
                        activity: 'å®æˆ˜å¯¹æŠ—ï¼ˆå¢¨å®¶å¼Ÿå­ï¼‰',
                        description: 'ä¸å…¶ä»–å¢¨å®¶å¼Ÿå­è¿›è¡Œå®æˆ˜è®­ç»ƒï¼Œæ£€éªŒä¿®è¡Œæˆæœã€‚',
                        color: '#DEB887',
                        angle: 225,
                        specialEvent: 'é¦–æ¬¡æ¿€æ´»"æ˜Ÿè¾‰æŠ¤ä½“"'
                    },
                    {
                        name: 'é…‰æ—¶',
                        time: '17:00-19:00',
                        activity: 'æŠ€è‰ºåˆ›ä½œ',
                        description: 'æ ¹æ®æ‰€å­¦åˆ›ä½œæœºå…³ä½œå“æˆ–è¿›è¡ŒæŠ€èƒ½ä¸“ç²¾è®­ç»ƒã€‚',
                        color: '#F4A460',
                        angle: 270
                    },
                    {
                        name: 'æˆŒæ—¶',
                        time: '19:00-21:00',
                        activity: 'æ™šè¯¾æ€»ç»“',
                        description: 'æ€»ç»“ä¸€å¤©æ‰€å­¦ï¼Œä¸å¸ˆçˆ¶è®¨è®ºä¿®è¡Œå¿ƒå¾—ã€‚',
                        color: '#CD853F',
                        angle: 315
                    }
                ];
                
                this.init();
            }
            
            init() {
                console.log('ğŸ¬ é•œå¤´7ï¼šæ—¶è¾°è½®ç›˜ä¿®è¡Œåˆå§‹åŒ–');
                this.createTimeWheel();
                this.updateCurrentActivity();
                this.updateStatus();
                
                // è‡ªåŠ¨å¼€å§‹ç¬¬ä¸€ä¸ªä¿®è¡Œ
                setTimeout(() => {
                    this.startCultivation();
                }, 2000);
            }
            
            createTimeWheel() {
                this.timeSlots.forEach((slot, index) => {
                    const sector = document.createElement('div');
                    sector.className = 'time-sector';
                    sector.style.transform = `rotate(${slot.angle}deg)`;
                    sector.style.background = `linear-gradient(45deg, ${slot.color} 0%, transparent 100%)`;
                    
                    if (index === this.currentTimeSlot) {
                        sector.classList.add('active');
                    }
                    
                    const label = document.createElement('div');
                    label.className = 'sector-label';
                    label.textContent = slot.name;
                    label.style.transform = `translate(-50%, -50%) rotate(-${slot.angle}deg)`;
                    
                    const activity = document.createElement('div');
                    activity.className = 'sector-activity';
                    activity.innerHTML = slot.activity.split('ï¼ˆ')[0];
                    activity.style.transform = `translate(-50%, -50%) rotate(-${slot.angle}deg)`;
                    
                    sector.appendChild(label);
                    sector.appendChild(activity);
                    
                    sector.addEventListener('click', () => {
                        this.selectTimeSlot(index);
                    });
                    
                    this.timeWheel.appendChild(sector);
                });
            }
            
            selectTimeSlot(index) {
                console.log(`â° é€‰æ‹©æ—¶è¾°: ${this.timeSlots[index].name}`);
                this.currentTimeSlot = index;
                this.updateTimeWheelDisplay();
                this.updateCurrentActivity();
                this.updateStatus();
            }
            
            updateTimeWheelDisplay() {
                const sectors = this.timeWheel.querySelectorAll('.time-sector');
                sectors.forEach((sector, index) => {
                    if (index === this.currentTimeSlot) {
                        sector.classList.add('active');
                    } else {
                        sector.classList.remove('active');
                    }
                });
            }
            
            updateCurrentActivity() {
                const slot = this.timeSlots[this.currentTimeSlot];
                this.currentTimeSpan.textContent = slot.name;
                this.timeRangeSpan.textContent = slot.time;
                this.activityName.textContent = slot.activity;
                this.activityDescription.textContent = slot.description;
            }
            
            startCultivation() {
                if (this.isTraining) return;
                
                console.log('ğŸ§˜ å¼€å§‹ä¿®è¡Œ');
                this.isTraining = true;
                this.cultivationProgress = 0;
                this.activityProgress.style.width = '0%';
                
                // æ¨¡æ‹Ÿä¿®è¡Œè¿›åº¦
                const progressInterval = setInterval(() => {
                    this.cultivationProgress += 10;
                    this.activityProgress.style.width = this.cultivationProgress + '%';
                    this.cultivationProgressSpan.textContent = this.cultivationProgress + '%';
                    
                    if (this.cultivationProgress >= 100) {
                        clearInterval(progressInterval);
                        this.completeCultivation();
                    }
                }, 300);
                
                // æ£€æŸ¥æ˜¯å¦æœ‰ç‰¹æ®Šäº‹ä»¶
                const slot = this.timeSlots[this.currentTimeSlot];
                if (slot.specialEvent && Math.random() < 0.7) {
                    setTimeout(() => {
                        this.triggerSpecialEvent(slot.specialEvent);
                    }, 1500);
                }
            }
            
            completeCultivation() {
                console.log('âœ… ä¿®è¡Œå®Œæˆ');
                this.isTraining = false;
                this.gainedExp += 20;
                this.gainedExpSpan.textContent = this.gainedExp;
                
                // æ›´æ–°æ—¥ç¨‹è¡¨
                this.updateScheduleDisplay();
                
                // è‡ªåŠ¨è¿›å…¥ä¸‹ä¸€æ—¶è¾°
                setTimeout(() => {
                    this.nextTimeSlot();
                }, 1000);
            }
            
            nextTimeSlot() {
                if (this.currentTimeSlot < this.timeSlots.length - 1) {
                    this.selectTimeSlot(this.currentTimeSlot + 1);
                } else {
                    this.completeDayTraining();
                }
            }
            
            completeDayTraining() {
                console.log('ğŸŒŸ ä¸€å¤©ä¿®è¡Œå®Œæˆ');
                this.showSpecialEvent('ğŸŒŸ ä¿®è¡Œæ—¥ç¨‹å®Œæˆ', 'ä¸€å¤©çš„ä¿®è¡Œåœ†æ»¡ç»“æŸï¼ä½ åœ¨å¢¨å®¶å·¨å­çš„æŒ‡å¯¼ä¸‹ï¼Œå­¦ä¼šäº†åŸºç¡€çš„æœºå…³æœ¯å’Œå¥‡é—¨éç”²ï¼Œå®åŠ›å¤§å¤§æå‡ã€‚æ˜å¤©å°†é¢ä¸´æ›´å¤§çš„æŒ‘æˆ˜...');
            }
            
            triggerSpecialEvent(eventText = null) {
                const events = [
                    {
                        title: 'âš¡ ç‰ä½©å…±é¸£',
                        description: 'ä¿®è¡Œè¿‡ç¨‹ä¸­ï¼Œç‰ä½©çªç„¶å‘å‡ºå¼ºçƒˆçš„å…‰èŠ’ï¼Œä½ æ„Ÿè§‰åˆ°ä¸€è‚¡æš–æµåœ¨ä½“å†…æµè½¬ï¼Œæ˜Ÿè¾‰ä¹‹åŠ›å¾—åˆ°äº†æ˜¾è‘—æå‡ï¼'
                    },
                    {
                        title: 'ğŸ”§ æœºå…³å¤±æ§',
                        description: 'åœ¨å­¦ä¹ æœºå…³æœ¯æ—¶ï¼Œä½ è¯¯è§¦äº†ä¸€ä¸ªå¤æ‚æœºå…³ï¼Œæ•´åº§æœºå…³åŸè­¦æŠ¥å¤§ä½œï¼å¥½åœ¨å¢¨å®¶å·¨å­åŠæ—¶èµ¶åˆ°åŒ–è§£äº†å±æœºã€‚'
                    },
                    {
                        title: 'ğŸ“œ å‘ç°ç§˜ç±',
                        description: 'åœ¨ç ”è¯»å…¸ç±æ—¶ï¼Œå¬´æ”¿å‘ç°äº†ä¸€æœ¬ã€Šé¾™é­‚ç‰å½•ã€‹çš„æ®‹å·ï¼Œå…¶ä¸­è®°è½½ç€å…³äºç‰ä½©çš„å¤è€ç§˜å¯†...'
                    },
                    {
                        title: 'ğŸŒ€ å¹»é˜µå›°å¢ƒ',
                        description: 'åœ¨å¥‡é—¨éç”²æ¼”ç»ƒä¸­ï¼Œä½ å’Œå¬´æ”¿è¢«å›°åœ¨ä¸€ä¸ªå¤æ‚çš„å¹»é˜µä¸­ï¼Œå¿…é¡»åˆä½œæ‰èƒ½ç ´è§£é˜µæ³•è„±èº«ã€‚'
                    },
                    {
                        title: 'ğŸ’« æ˜Ÿè¾‰æŠ¤ä½“',
                        description: 'åœ¨å®æˆ˜å¯¹æŠ—ä¸­ï¼Œå±æ€¥æ—¶åˆ»ä½ é¦–æ¬¡æ¿€æ´»äº†"æ˜Ÿè¾‰æŠ¤ä½“"èƒ½åŠ›ï¼Œèº«ä½“è¢«æ·¡æ·¡çš„æ˜Ÿå…‰åŒ…å›´ï¼Œé˜²å¾¡åŠ›å¤§å¢ï¼'
                    }
                ];
                
                let event;
                if (eventText) {
                    event = {
                        title: 'ğŸ“… æ—¶è¾°ç‰¹æ®Šäº‹ä»¶',
                        description: eventText
                    };
                } else {
                    event = events[Math.floor(Math.random() * events.length)];
                }
                
                this.showSpecialEvent(event.title, event.description);
            }
            
            showSpecialEvent(title, description) {
                this.eventTitle.textContent = title;
                this.eventDescription.textContent = description;
                this.specialEvent.classList.add('show');
            }
            
            closeSpecialEvent() {
                this.specialEvent.classList.remove('show');
            }
            
            selectMaster(masterId) {
                console.log(`ğŸ‘¨â€ğŸ« é€‰æ‹©å¸ˆçˆ¶: ${masterId}`);
                this.selectedMaster = masterId;
                
                // æ›´æ–°UI
                document.querySelectorAll('.master-card').forEach(card => {
                    card.classList.remove('selected');
                });
                event.target.closest('.master-card').classList.add('selected');
                
                const masterNames = {
                    jingke: 'è†è½²',
                    mozi: 'å¢¨å­',
                    liguang: 'æå¹¿',
                    yuefei: 'å²³é£',
                    huatuo: 'åä½—',
                    zuoci: 'å·¦æ…ˆ'
                };
                
                this.selectedMasterSpan.textContent = masterNames[masterId];
                
                // æ˜¾ç¤ºé€‰æ‹©ç»“æœ
                this.showSpecialEvent('ğŸ“ å¸ˆçˆ¶é€‰æ‹©', `ä½ é€‰æ‹©äº†${masterNames[masterId]}ä½œä¸ºå¸ˆçˆ¶ï¼ä»–å°†æ•™æˆä½ ä¸“å±çš„æŠ€èƒ½è·¯çº¿ï¼Œå¼€å¯ä¸åŒçš„ä¿®è¡Œé“è·¯ã€‚`);
            }
            
            updateScheduleDisplay() {
                const scheduleItems = document.querySelectorAll('.schedule-item');
                scheduleItems.forEach((item, index) => {
                    if (index < this.currentTimeSlot) {
                        item.classList.add('completed');
                        item.classList.remove('current');
                    } else if (index === this.currentTimeSlot) {
                        item.classList.add('current');
                        item.classList.remove('completed');
                    } else {
                        item.classList.remove('current', 'completed');
                    }
                });
            }
            
            autoProgress() {
                console.log('ğŸ¤– è‡ªåŠ¨è¿›åº¦');
                const autoAdvance = () => {
                    if (this.currentTimeSlot < this.timeSlots.length - 1) {
                        this.startCultivation();
                        setTimeout(() => {
                            this.nextTimeSlot();
                            setTimeout(autoAdvance, 1000);
                        }, 2000);
                    } else {
                        this.completeDayTraining();
                    }
                };
                autoAdvance();
            }
            
            nextScene() {
                console.log('â¡ï¸ å®Œæˆä¿®è¡Œï¼Œå‰å¾€ä¸‹ä¸€é•œå¤´');
                alert('é•œå¤´7å®Œæˆï¼\n\næ—¶è¾°è½®ç›˜ä¿®è¡Œç³»ç»Ÿå±•ç¤ºå®Œæˆ\nå¢¨å®¶æœºå…³åŸæ—¥å¸¸ä½“éªŒç»“æŸ\nå¸ˆçˆ¶é€‰æ‹©ç¡®å®š\nä¿®è¡Œèƒ½åŠ›å¤§å¹…æå‡\n\næ•…äº‹è¿›å…¥æ–°çš„ç¯‡ç« ...');
            }
            
            restartScene() {
                console.log('ğŸ”„ é‡æ–°å¼€å§‹é•œå¤´7');
                location.reload();
            }
            
            updateStatus() {
                this.statusTime.textContent = this.timeSlots[this.currentTimeSlot].name;
            }
        }
        
        // å…¨å±€å‡½æ•°
        let scene7Instance;
        
        window.addEventListener('DOMContentLoaded', () => {
            scene7Instance = new Scene7Cultivation();
        });
        
        function startCultivation() {
            scene7Instance.startCultivation();
        }
        
        function nextTimeSlot() {
            scene7Instance.nextTimeSlot();
        }
        
        function triggerSpecialEvent() {
            scene7Instance.triggerSpecialEvent();
        }
        
        function autoProgress() {
            scene7Instance.autoProgress();
        }
        
        function selectMaster(masterId) {
            scene7Instance.selectMaster(masterId);
        }
        
        function closeSpecialEvent() {
            scene7Instance.closeSpecialEvent();
        }
        
        function nextScene() {
            scene7Instance.nextScene();
        }
        
        function restartScene() {
            scene7Instance.restartScene();
        }
        
        // å¿«æ·é”®æ”¯æŒ
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case ' ':
                    e.preventDefault();
                    startCultivation();
                    break;
                case 'Enter':
                    e.preventDefault();
                    nextTimeSlot();
                    break;
                case 'e':
                case 'E':
                    triggerSpecialEvent();
                    break;
                case 'a':
                case 'A':
                    autoProgress();
                    break;
                case 'n':
                case 'N':
                    nextScene();
                    break;
                case 'r':
                case 'R':
                    restartScene();
                    break;
                case 'Escape':
                    closeSpecialEvent();
                    break;
            }
        });
        
        console.log('ğŸ® é•œå¤´7æ§åˆ¶ï¼šç©ºæ ¼=å¼€å§‹ä¿®è¡Œ, å›è½¦=ä¸‹ä¸€æ—¶è¾°, E=ç‰¹æ®Šäº‹ä»¶, A=è‡ªåŠ¨è¿›åº¦, N=ä¸‹ä¸€é•œå¤´, R=é‡å¯, ESC=å…³é—­å¼¹çª—');
    </script>
</body>
</html> 