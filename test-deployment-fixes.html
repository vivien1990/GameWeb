<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éƒ¨ç½²é—®é¢˜ä¿®å¤éªŒè¯</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a2e;
            color: white;
            font-family: 'Microsoft YaHei', sans-serif;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        
        .test-button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 30px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .test-button:hover {
            background: #45a049;
        }
        
        .test-button.warning {
            background: #ff9800;
        }
        
        .test-button.error {
            background: #f44336;
        }
        
        .status {
            margin: 10px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
        }
        
        .iframe-container {
            width: 100%;
            height: 400px;
            border: 2px solid #333;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .log {
            background: #000;
            color: #0f0;
            padding: 10px;
            border-radius: 5px;
            max-height: 200px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        
        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .keyboard-test {
            background: rgba(0, 255, 0, 0.1);
            border: 2px solid #4CAF50;
            padding: 15px;
            border-radius: 10px;
        }
        
        .video-test {
            background: rgba(255, 165, 0, 0.1);
            border: 2px solid #ff9800;
            padding: 15px;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”§ éƒ¨ç½²é—®é¢˜ä¿®å¤éªŒè¯</h1>
        
        <div class="test-section">
            <h2>ğŸ¯ ä¿®å¤å†…å®¹æ€»ç»“</h2>
            <div class="grid">
                <div class="video-test">
                    <h3>ğŸ¬ é•œå¤´5è§†é¢‘åˆ‡æ¢é»‘å±ä¿®å¤</h3>
                    <ul>
                        <li>âœ… æ·»åŠ è§†é¢‘é¢„åŠ è½½ç³»ç»Ÿ</li>
                        <li>âœ… C05003-2.mp4æ’­æ”¾æ—¶é¢„åŠ è½½C05003-1.mp4</li>
                        <li>âœ… ç­‰å¾…è§†é¢‘å‡†å¤‡å°±ç»ªå†æ’­æ”¾</li>
                        <li>âœ… æ— ç¼è§†é¢‘åˆ‡æ¢</li>
                    </ul>
                </div>
                <div class="keyboard-test">
                    <h3>âŒ¨ï¸ æ§åˆ¶å°å¿«æ·é”®ä¿®å¤</h3>
                    <ul>
                        <li>âœ… å¢å¼ºé”®ç›˜äº‹ä»¶ç›‘å¬</li>
                        <li>âœ… å¤šå±‚çº§äº‹ä»¶å¤„ç†</li>
                        <li>âœ… iframeæ¶ˆæ¯ä¼ é€’ä¼˜åŒ–</li>
                        <li>âœ… éƒ¨ç½²ç¯å¢ƒå…¼å®¹æ€§</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ® æ§åˆ¶å°å¿«æ·é”®æµ‹è¯•</h2>
            <div class="status" id="keyboard-status">å‡†å¤‡æµ‹è¯•é”®ç›˜å¿«æ·é”®...</div>
            <p><strong>æµ‹è¯•è¯´æ˜ï¼š</strong>åœ¨ä¸‹é¢çš„iframeä¸­æŒ‰ <code>~</code> æˆ– <code>T</code> é”®ï¼Œè§‚å¯Ÿæ§åˆ¶å°æ˜¯å¦æ­£å¸¸åˆ‡æ¢</p>
            <div class="iframe-container">
                <iframe id="story-frame" src="index-story.html"></iframe>
            </div>
            <button class="test-button" onclick="testKeyboard()">æµ‹è¯•æ§åˆ¶å°åˆ‡æ¢</button>
            <button class="test-button warning" onclick="enableKeyboardDebug()">å¯ç”¨é”®ç›˜è°ƒè¯•</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ¬ é•œå¤´5è§†é¢‘åˆ‡æ¢æµ‹è¯•</h2>
            <div class="status" id="video-status">å‡†å¤‡æµ‹è¯•è§†é¢‘åˆ‡æ¢...</div>
            <p><strong>æµ‹è¯•è¯´æ˜ï¼š</strong>è·³è½¬åˆ°é•œå¤´5ï¼Œè§‚å¯ŸC05003-2.mp4åˆ°C05003-1.mp4çš„åˆ‡æ¢æ˜¯å¦æ— é»‘å±</p>
            <div class="iframe-container">
                <iframe id="scene5-frame" src="scene5-new.html"></iframe>
            </div>
            <button class="test-button" onclick="goToScene5()">è·³è½¬åˆ°é•œå¤´5</button>
            <button class="test-button" onclick="skipToPhase3()">ç›´æ¥åˆ°é˜¶æ®µ3é€‰æ‹©</button>
            <button class="test-button warning" onclick="testVideoTransition()">æµ‹è¯•è§†é¢‘åˆ‡æ¢</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“Š æµ‹è¯•çŠ¶æ€</h2>
            <div class="status" id="overall-status">ç­‰å¾…æµ‹è¯•...</div>
            <button class="test-button" onclick="runAllTests()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
            <button class="test-button error" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“ æµ‹è¯•æ—¥å¿—</h2>
            <div class="log" id="log"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ” éƒ¨ç½²éªŒè¯æ¸…å•</h2>
            <div class="grid">
                <div>
                    <h4>âœ… æœ¬åœ°æµ‹è¯•ç¡®è®¤</h4>
                    <ul>
                        <li>æ§åˆ¶å°å¿«æ·é”®æ­£å¸¸</li>
                        <li>è§†é¢‘åˆ‡æ¢æ— é»‘å±</li>
                        <li>æ‰€æœ‰åŠŸèƒ½æ­£å¸¸</li>
                    </ul>
                </div>
                <div>
                    <h4>ğŸš€ éƒ¨ç½²åéªŒè¯</h4>
                    <ul>
                        <li>Netlifyéƒ¨ç½²æˆåŠŸ</li>
                        <li>æ§åˆ¶å°å¿«æ·é”®æµ‹è¯•</li>
                        <li>é•œå¤´5è§†é¢‘åˆ‡æ¢æµ‹è¯•</li>
                        <li>å„é•œå¤´åŠŸèƒ½æµ‹è¯•</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        const logDiv = document.getElementById('log');
        const keyboardStatus = document.getElementById('keyboard-status');
        const videoStatus = document.getElementById('video-status');
        const overallStatus = document.getElementById('overall-status');
        
        function addLog(message) {
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${timestamp}] ${message}<br>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function updateKeyboardStatus(message) {
            keyboardStatus.textContent = message;
            addLog(`é”®ç›˜çŠ¶æ€: ${message}`);
        }
        
        function updateVideoStatus(message) {
            videoStatus.textContent = message;
            addLog(`è§†é¢‘çŠ¶æ€: ${message}`);
        }
        
        function updateOverallStatus(message) {
            overallStatus.textContent = message;
            addLog(`æ€»ä½“çŠ¶æ€: ${message}`);
        }
        
        function testKeyboard() {
            updateKeyboardStatus('æ­£åœ¨æµ‹è¯•é”®ç›˜å¿«æ·é”®...');
            addLog('å¼€å§‹é”®ç›˜æµ‹è¯•ï¼šè¯·åœ¨iframeä¸­æŒ‰ ~ æˆ– T é”®');
            
            // å‘é€æµ‹è¯•ä¿¡å·
            const iframe = document.getElementById('story-frame');
            if (iframe && iframe.contentWindow) {
                iframe.contentWindow.postMessage({type: 'test-keyboard'}, '*');
            }
        }
        
        function enableKeyboardDebug() {
            updateKeyboardStatus('å¯ç”¨é”®ç›˜è°ƒè¯•æ¨¡å¼...');
            addLog('å¯ç”¨é”®ç›˜è°ƒè¯•æ¨¡å¼');
            
            // å‘é€è°ƒè¯•å¯ç”¨ä¿¡å·ç»™æ‰€æœ‰iframe
            const iframes = document.querySelectorAll('iframe');
            iframes.forEach(iframe => {
                if (iframe.contentWindow) {
                    iframe.contentWindow.postMessage({type: 'enable-keyboard-debug'}, '*');
                }
            });
        }
        
        function goToScene5() {
            updateVideoStatus('è·³è½¬åˆ°é•œå¤´5...');
            addLog('è·³è½¬åˆ°é•œå¤´5');
            
            const iframe = document.getElementById('story-frame');
            if (iframe && iframe.contentWindow) {
                iframe.contentWindow.postMessage({type: 'go-to-scene', scene: 5}, '*');
            }
        }
        
        function skipToPhase3() {
            updateVideoStatus('è·³è½¬åˆ°é•œå¤´5é˜¶æ®µ3...');
            addLog('è·³è½¬åˆ°é•œå¤´5é˜¶æ®µ3');
            
            const iframe = document.getElementById('scene5-frame');
            if (iframe && iframe.contentWindow) {
                iframe.contentWindow.postMessage({type: 'skip-to-phase', phase: 3}, '*');
            }
        }
        
        function testVideoTransition() {
            updateVideoStatus('æµ‹è¯•è§†é¢‘åˆ‡æ¢...');
            addLog('å¼€å§‹æµ‹è¯•è§†é¢‘åˆ‡æ¢');
            
            const iframe = document.getElementById('scene5-frame');
            if (iframe && iframe.contentWindow) {
                iframe.contentWindow.postMessage({type: 'test-video-transition'}, '*');
            }
        }
        
        function runAllTests() {
            updateOverallStatus('è¿è¡Œæ‰€æœ‰æµ‹è¯•...');
            addLog('=== å¼€å§‹å…¨é¢æµ‹è¯• ===');
            
            // ä¾æ¬¡è¿è¡Œæ‰€æœ‰æµ‹è¯•
            setTimeout(() => testKeyboard(), 500);
            setTimeout(() => enableKeyboardDebug(), 1000);
            setTimeout(() => goToScene5(), 1500);
            setTimeout(() => skipToPhase3(), 2000);
            
            setTimeout(() => {
                updateOverallStatus('æ‰€æœ‰æµ‹è¯•å·²å¯åŠ¨ï¼Œè¯·è§‚å¯Ÿç»“æœ');
                addLog('=== æ‰€æœ‰æµ‹è¯•å·²å¯åŠ¨ ===');
            }, 2500);
        }
        
        function clearLog() {
            logDiv.innerHTML = '';
            addLog('æ—¥å¿—å·²æ¸…ç©º');
        }
        
        // ç›‘å¬æ¥è‡ªiframeçš„æ¶ˆæ¯
        window.addEventListener('message', (event) => {
            if (event.data.type) {
                addLog(`æ”¶åˆ°æ¶ˆæ¯: ${event.data.type}`);
                
                switch(event.data.type) {
                    case 'console-toggle-result':
                        updateKeyboardStatus(`æ§åˆ¶å°${event.data.visible ? 'æ˜¾ç¤º' : 'éšè—'} - å¿«æ·é”®æ­£å¸¸å·¥ä½œ!`);
                        break;
                    case 'video-loading':
                        updateVideoStatus(`è§†é¢‘åŠ è½½: ${event.data.message}`);
                        break;
                    case 'video-transition-start':
                        updateVideoStatus('è§†é¢‘åˆ‡æ¢å¼€å§‹...');
                        break;
                    case 'video-transition-complete':
                        updateVideoStatus('è§†é¢‘åˆ‡æ¢å®Œæˆ - æ— é»‘å±!');
                        break;
                    case 'scene5-phase-update':
                        updateVideoStatus(`é•œå¤´5: ${event.data.phase}`);
                        break;
                }
            }
        });
        
        // é¡µé¢åŠ è½½å®Œæˆ
        document.addEventListener('DOMContentLoaded', () => {
            updateOverallStatus('æµ‹è¯•ç¯å¢ƒå·²åŠ è½½');
            addLog('éƒ¨ç½²é—®é¢˜ä¿®å¤éªŒè¯å·¥å…·å·²å¯åŠ¨');
            
            // ç­‰å¾…iframeåŠ è½½
            const storyFrame = document.getElementById('story-frame');
            const scene5Frame = document.getElementById('scene5-frame');
            
            storyFrame.addEventListener('load', () => {
                addLog('æ•…äº‹ç®¡ç†å™¨é¡µé¢åŠ è½½å®Œæˆ');
                updateKeyboardStatus('æ•…äº‹é¡µé¢å·²åŠ è½½ï¼Œå¯ä»¥æµ‹è¯•æ§åˆ¶å°å¿«æ·é”®');
            });
            
            scene5Frame.addEventListener('load', () => {
                addLog('é•œå¤´5é¡µé¢åŠ è½½å®Œæˆ');
                updateVideoStatus('é•œå¤´5å·²åŠ è½½ï¼Œå¯ä»¥æµ‹è¯•è§†é¢‘åˆ‡æ¢');
            });
        });
        
        // å¿«æ·é”®æ”¯æŒ
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case '1':
                    testKeyboard();
                    break;
                case '2':
                    goToScene5();
                    break;
                case '3':
                    skipToPhase3();
                    break;
                case '4':
                    testVideoTransition();
                    break;
                case '5':
                    runAllTests();
                    break;
                case 'c':
                case 'C':
                    clearLog();
                    break;
                case 'd':
                case 'D':
                    enableKeyboardDebug();
                    break;
            }
        });
        
        addLog('å¿«æ·é”®: 1=æµ‹è¯•é”®ç›˜, 2=é•œå¤´5, 3=é˜¶æ®µ3, 4=è§†é¢‘åˆ‡æ¢, 5=å…¨æµ‹è¯•, C=æ¸…ç©º, D=è°ƒè¯•');
    </script>
</body>
</html> 