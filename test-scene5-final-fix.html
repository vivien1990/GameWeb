<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•œå¤´5æœ€ç»ˆä¿®å¤éªŒè¯</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
            font-family: Arial, sans-serif;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .fix-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #2a2a2a;
            border-radius: 10px;
        }
        
        .section-title {
            color: #ffcc00;
            margin-bottom: 15px;
        }
        
        .fix-status {
            background: #2d5a2d;
            color: #90EE90;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .issue-fix {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .issue, .fix {
            padding: 15px;
            border-radius: 8px;
        }
        
        .issue {
            background: #5a2d2d;
            color: #ffaaaa;
        }
        
        .fix {
            background: #2d5a2d;
            color: #90EE90;
        }
        
        .code-sample {
            background: #333;
            color: #ccc;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            margin: 10px 0;
            white-space: pre-wrap;
        }
        
        .control-button {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 20px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .control-button:hover {
            background: linear-gradient(45deg, #45a049, #4CAF50);
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #444;
        }
        
        .feature-list li:last-child {
            border-bottom: none;
        }
        
        .highlight {
            background: #4a4a4a;
            padding: 2px 6px;
            border-radius: 3px;
            color: #ffcc00;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 style="color: #ffcc00; text-align: center;">ğŸ”§ é•œå¤´5æœ€ç»ˆä¿®å¤éªŒè¯</h1>
        <p style="text-align: center; color: #ccc;">éªŒè¯æŒ‰é’®é‡å¤é—®é¢˜ã€è§†é¢‘æš‚åœå’Œæˆ˜æ–—èƒœåˆ©ç•Œé¢çš„æ‰€æœ‰ä¿®å¤</p>
        
        <!-- ä¿®å¤çŠ¶æ€æ€»è§ˆ -->
        <div class="fix-status">
            <h3>âœ… æœ€ç»ˆä¿®å¤å®ŒæˆçŠ¶æ€</h3>
            <ul>
                <li>âœ… <strong>æŒ‰é’®é‡å¤é—®é¢˜</strong>ï¼šä½¿ç”¨æ›´ç²¾ç¡®çš„çŠ¶æ€æ£€æŸ¥ï¼Œé˜²æ­¢"å‘ç”Ÿä»€ä¹ˆäº†"æŒ‰é’®é‡å¤æ˜¾ç¤º</li>
                <li>âœ… <strong>è§†é¢‘æš‚åœæ§åˆ¶</strong>ï¼šC05003-1.mp4æ’­å®Œåæš‚åœåœ¨æœ€åä¸€å¸§</li>
                <li>âœ… <strong>èƒœåˆ©ç•Œé¢ä¼˜åŒ–</strong>ï¼šå»æ‰"è‹±é›„æ•‘ç¾æˆåŠŸ"ï¼Œä¿æŒç®€æ´</li>
                <li>âœ… <strong>äº‹ä»¶ç›‘å¬æ¸…ç†</strong>ï¼šæ¯ä¸ªé˜¶æ®µéƒ½æ¸…ç†ä¹‹å‰çš„äº‹ä»¶ç›‘å¬å™¨</li>
                <li>âœ… <strong>çŠ¶æ€ç®¡ç†</strong>ï¼šæ·»åŠ å®Œæ•´çš„åœºæ™¯æ¸…ç†æœºåˆ¶</li>
            </ul>
        </div>
        
        <!-- é—®é¢˜1ï¼šæŒ‰é’®é‡å¤æ˜¾ç¤º -->
        <div class="fix-section">
            <h3 class="section-title">ğŸ”˜ é—®é¢˜1ï¼šæŒ‰é’®é‡å¤æ˜¾ç¤ºçš„æ ¹æœ¬ä¿®å¤</h3>
            
            <div class="issue-fix">
                <div class="issue">
                    <h4>âŒ åŸå§‹é—®é¢˜</h4>
                    <div class="code-sample">// æ£€æŸ¥é€»è¾‘ä¸å¤Ÿç²¾ç¡®
if (!this.actionButton.classList.contains('hidden')) return;

// é—®é¢˜ï¼šå¯èƒ½åŒæ—¶æœ‰ hidden å’Œ show ç±»
// å¯¼è‡´æ£€æŸ¥å¤±æ•ˆï¼ŒæŒ‰é’®é‡å¤æ˜¾ç¤º</div>
                    <p>é—®é¢˜ï¼š"å‘ç”Ÿä»€ä¹ˆäº†"æŒ‰é’®åœ¨æŸäº›æƒ…å†µä¸‹é‡å¤å‡ºç°</p>
                </div>
                
                <div class="fix">
                    <h4>âœ… æ ¹æœ¬ä¿®å¤</h4>
                    <div class="code-sample">// ç›´æ¥æ£€æŸ¥ show çŠ¶æ€
if (this.actionButton.classList.contains('show')) {
  console.log('âš ï¸ æŒ‰é’®å·²æ˜¾ç¤ºï¼Œè·³è¿‡é‡å¤æ˜¾ç¤º');
  return;
}

// åŒæ—¶æ¸…ç†æ‰€æœ‰è§†é¢‘äº‹ä»¶ç›‘å¬å™¨
this.mainVideo.onended = null;
this.mainVideo.ontimeupdate = null;</div>
                    <p>ç‰¹ç‚¹ï¼šç²¾ç¡®çš„çŠ¶æ€æ£€æŸ¥ + äº‹ä»¶ç›‘å¬å™¨æ¸…ç†</p>
                </div>
            </div>
            
            <h4>ä¿®å¤å…³é”®ç‚¹ï¼š</h4>
            <ul class="feature-list">
                <li>ğŸ¯ <strong>ç²¾ç¡®æ£€æŸ¥</strong>ï¼šç›´æ¥æ£€æŸ¥ <span class="highlight">show</span> ç±»è€Œä¸æ˜¯ <span class="highlight">hidden</span> ç±»</li>
                <li>ğŸ§¹ <strong>äº‹ä»¶æ¸…ç†</strong>ï¼šæ¯ä¸ªé˜¶æ®µå¼€å§‹å‰æ¸…ç†æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨</li>
                <li>ğŸ“ <strong>è°ƒè¯•æ—¥å¿—</strong>ï¼šæ·»åŠ è¯¦ç»†çš„æ§åˆ¶å°è¾“å‡ºä¾¿äºè°ƒè¯•</li>
                <li>ğŸ”’ <strong>çŠ¶æ€é‡ç½®</strong>ï¼šé‡å¯æ—¶å®Œæ•´é‡ç½®æ‰€æœ‰çŠ¶æ€</li>
            </ul>
        </div>
        
        <!-- é—®é¢˜2ï¼šè§†é¢‘æš‚åœæ§åˆ¶ -->
        <div class="fix-section">
            <h3 class="section-title">ğŸ¬ é—®é¢˜2ï¼šæœ€ç»ˆè§†é¢‘æš‚åœæ§åˆ¶</h3>
            
            <div class="issue-fix">
                <div class="issue">
                    <h4>âŒ åŸå§‹é—®é¢˜</h4>
                    <div class="code-sample">// åªç›‘å¬è§†é¢‘ç»“æŸäº‹ä»¶
this.mainVideo.onended = () => {
  this.completeScene();
};

// é—®é¢˜ï¼šè§†é¢‘æ’­æ”¾å®Œä¼šè‡ªç„¶ç»“æŸ
// æ— æ³•æš‚åœåœ¨æœ€åä¸€å¸§</div>
                    <p>é—®é¢˜ï¼šC05003-1.mp4æ’­å®Œç›´æ¥ç»“æŸï¼Œæ— æ³•æš‚åœåœ¨æœ€åä¸€å¸§</p>
                </div>
                
                <div class="fix">
                    <h4>âœ… ä¿®å¤æ–¹æ¡ˆ</h4>
                    <div class="code-sample">// ç›‘å¬æ—¶é—´æ›´æ–°ï¼Œä¸»åŠ¨æš‚åœ
this.mainVideo.ontimeupdate = () => {
  if (this.mainVideo.duration > 0 && 
      this.mainVideo.currentTime >= this.mainVideo.duration - 0.1) {
    this.mainVideo.pause(); // æš‚åœåœ¨æœ€åä¸€å¸§
    this.mainVideo.ontimeupdate = null;
    this.completeScene();
  }
};</div>
                    <p>ç‰¹ç‚¹ï¼šç²¾ç¡®æ§åˆ¶æš‚åœæ—¶æœºï¼Œä¿æŒæœ€åç”»é¢</p>
                </div>
            </div>
        </div>
        
        <!-- é—®é¢˜3ï¼šæˆ˜æ–—èƒœåˆ©ç•Œé¢ä¼˜åŒ– -->
        <div class="fix-section">
            <h3 class="section-title">ğŸ† é—®é¢˜3ï¼šæˆ˜æ–—èƒœåˆ©ç•Œé¢æ–‡æ¡ˆä¼˜åŒ–</h3>
            
            <div class="issue-fix">
                <div class="issue">
                    <h4>âŒ ä¿®å¤å‰</h4>
                    <div class="code-sample">âš”ï¸ æˆ˜æ–—èƒœåˆ©ï¼ âš”ï¸
è‹±é›„æ•‘ç¾æˆåŠŸ           â† éœ€è¦åˆ é™¤

ä½ å‹‡æ•¢åœ°æŒºèº«è€Œå‡ºï¼Œä¿æŠ¤äº†æ— è¾œçš„ç”·å­©
è´µæ—å°‘å¹´åœ¨ä½ çš„å¨æ…‘ä¸‹è½è’è€Œé€ƒ
æ­£ä¹‰å¾—åˆ°äº†ä¼¸å¼ ï¼Œå–„è‰¯å¾—åˆ°äº†å®ˆæŠ¤

ğŸ† è·å¾—å±æ€§æå‡ï¼šæ­¦å¾· +5</div>
                    <p>é—®é¢˜ï¼šæ–‡æ¡ˆå†—ä½™ï¼Œ"è‹±é›„æ•‘ç¾æˆåŠŸ"ä¸æ ‡é¢˜é‡å¤</p>
                </div>
                
                <div class="fix">
                    <h4>âœ… ä¿®å¤å</h4>
                    <div class="code-sample">âš”ï¸ æˆ˜æ–—èƒœåˆ©ï¼ âš”ï¸

ä½ å‹‡æ•¢åœ°æŒºèº«è€Œå‡ºï¼Œä¿æŠ¤äº†æ— è¾œçš„ç”·å­©
è´µæ—å°‘å¹´åœ¨ä½ çš„å¨æ…‘ä¸‹è½è’è€Œé€ƒ
æ­£ä¹‰å¾—åˆ°äº†ä¼¸å¼ ï¼Œå–„è‰¯å¾—åˆ°äº†å®ˆæŠ¤

ğŸ† è·å¾—å±æ€§æå‡ï¼šæ­¦å¾· +5</div>
                    <p>ç‰¹ç‚¹ï¼šç®€æ´æ˜äº†ï¼Œç›´æ¥çªå‡ºæˆ˜æ–—èƒœåˆ©ä¸»é¢˜</p>
                </div>
            </div>
        </div>
        
        <!-- æŠ€æœ¯æ”¹è¿› -->
        <div class="fix-section">
            <h3 class="section-title">âš™ï¸ æŠ€æœ¯æ”¹è¿›æ€»ç»“</h3>
            
            <h4>äº‹ä»¶ç›‘å¬å™¨ç®¡ç†ï¼š</h4>
            <div class="code-sample">// æ¯ä¸ªé˜¶æ®µå¼€å§‹å‰ç»Ÿä¸€æ¸…ç†
this.mainVideo.onended = null;
this.mainVideo.ontimeupdate = null;

// ç„¶åè®¾ç½®æ–°çš„ç›‘å¬å™¨
this.mainVideo.onended = () => { /* æ–°é€»è¾‘ */ };
this.mainVideo.ontimeupdate = () => { /* æ–°é€»è¾‘ */ };</div>
            
            <h4>çŠ¶æ€ç®¡ç†æ”¹è¿›ï¼š</h4>
            <div class="code-sample">cleanupScene() {
  // æ¸…é™¤æ‰€æœ‰è§†é¢‘äº‹ä»¶ç›‘å¬å™¨
  this.mainVideo.onended = null;
  this.mainVideo.ontimeupdate = null;
  this.mainVideo.pause();
  
  // éšè—æ‰€æœ‰UIå…ƒç´ 
  this.hideActionButton();
  this.hideChoiceContainer();
  
  // é‡ç½®çŠ¶æ€å˜é‡
  this.currentPhase = 1;
  this.choiceMade = false;
  
  // ç§»é™¤èƒœåˆ©ç•Œé¢
  const victoryMessage = document.querySelector('div[style*="z-index: 99999"]');
  if (victoryMessage) victoryMessage.remove();
}</div>
            
            <h4>å®Œæ•´æµç¨‹æ§åˆ¶ï¼š</h4>
            <div class="code-sample">é˜¶æ®µ1 â†’ æ¸…ç†äº‹ä»¶ â†’ æ’­æ”¾è§†é¢‘ â†’ ç›‘å¬ç»“æŸ â†’ æ˜¾ç¤ºæŒ‰é’®ï¼ˆæ£€æŸ¥showçŠ¶æ€ï¼‰
é˜¶æ®µ2 â†’ æ¸…ç†äº‹ä»¶ â†’ æ’­æ”¾è§†é¢‘ â†’ ç›‘å¬æ—¶é—´ â†’ æš‚åœæ˜¾ç¤ºé€‰æ‹©
é€‰æ‹©å â†’ æ¸…ç†äº‹ä»¶ â†’ æ’­æ”¾ç»“æœ â†’ éœ‡æ’¼è½¬åœº
æœ€ç»ˆ â†’ æ¸…ç†äº‹ä»¶ â†’ æ’­æ”¾è§†é¢‘ â†’ ç›‘å¬æ—¶é—´ â†’ æš‚åœåœ¨æœ€åä¸€å¸§ â†’ èƒœåˆ©ç•Œé¢</div>
        </div>
        
        <!-- æµ‹è¯•é“¾æ¥ -->
        <div style="text-align: center; margin-top: 30px;">
            <button class="control-button" onclick="window.open('scene5-new.html', '_blank')">
                ğŸ¬ æµ‹è¯•é•œå¤´5ï¼ˆæœ€ç»ˆä¿®å¤ç‰ˆï¼‰
            </button>
            <button class="control-button" onclick="window.open('index-story.html', '_blank')">
                ğŸ­ æµ‹è¯•å®Œæ•´æ•…äº‹æµç¨‹
            </button>
            <button class="control-button" onclick="simulateVictoryFixed()">
                ğŸ† é¢„è§ˆä¿®å¤åèƒœåˆ©ç•Œé¢
            </button>
        </div>
    </div>
    
    <script>
        function simulateVictoryFixed() {
            // åˆ›å»ºä¿®å¤åçš„æˆ˜æ–—èƒœåˆ©ç•Œé¢
            const message = document.createElement('div');
            message.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: linear-gradient(135deg, rgba(0, 0, 0, 0.95) 0%, rgba(20, 40, 20, 0.95) 100%);
                color: #FFD700;
                padding: 50px;
                border-radius: 20px;
                border: 3px solid #FFD700;
                text-align: center;
                z-index: 99999;
                font-size: 18px;
                max-width: 600px;
                min-width: 500px;
                box-shadow: 
                    0 0 50px rgba(255, 215, 0, 0.5),
                    inset 0 1px 0 rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(15px);
                opacity: 0;
                animation: victoryFadeIn 0.8s ease-out forwards;
            `;
            
            message.innerHTML = `
                <div style="font-size: 36px; margin-bottom: 30px; color: #90EE90;">âš”ï¸ æˆ˜æ–—èƒœåˆ©ï¼ âš”ï¸</div>
                <div style="margin-bottom: 25px; color: #FFFFFF; line-height: 1.6;">
                    <p>ä½ å‹‡æ•¢åœ°æŒºèº«è€Œå‡ºï¼Œä¿æŠ¤äº†æ— è¾œçš„ç”·å­©</p>
                    <p>è´µæ—å°‘å¹´åœ¨ä½ çš„å¨æ…‘ä¸‹è½è’è€Œé€ƒ</p>
                    <p>æ­£ä¹‰å¾—åˆ°äº†ä¼¸å¼ ï¼Œå–„è‰¯å¾—åˆ°äº†å®ˆæŠ¤</p>
                </div>
                <div style="margin-bottom: 30px; color: #90EE90; font-size: 20px; font-weight: bold;">
                    ğŸ† è·å¾—å±æ€§æå‡ï¼šæ­¦å¾· +5
                </div>
                <button onclick="this.parentElement.remove()" 
                        style="padding: 15px 30px; background: linear-gradient(45deg, #FFD700, #FFA500); 
                               color: #000; border: none; border-radius: 12px; cursor: pointer; 
                               font-size: 18px; font-weight: bold; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
                               transition: all 0.3s ease;">
                    ç»§ç»­å†’é™© â¡ï¸
                </button>
            `;
            
            document.body.appendChild(message);
        }
        
        // æ·»åŠ åŠ¨ç”»æ ·å¼
        const style = document.createElement('style');
        style.textContent = `
            @keyframes victoryFadeIn {
                0% {
                    opacity: 0;
                    transform: translate(-50%, -50%) scale(0.8);
                }
                60% {
                    opacity: 1;
                    transform: translate(-50%, -50%) scale(1.05);
                }
                100% {
                    opacity: 1;
                    transform: translate(-50%, -50%) scale(1);
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html> 